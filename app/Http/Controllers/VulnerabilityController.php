<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Vulnerability;
use Intervention\Image\ImageManager;


class VulnerabilityController extends Controller
{
    public function index()
    {
        $vulns = Vulnerability::get();
    

        $vulns->each(function ($vulnerability) {

        
            preg_match("/(?P<filetype>\w+):\s+(?P<file>\S+)\s+Expected Version:\s+(?P<expected_version>\S+)\s+Existing Version:\s+(?P<existing_version>\S+)\s+?(?P<windows_update>\S+)/i", $vulnerability->FASL_output, $output_array);

        
            $windows_fix = "C:\\evan\psexec.exe -s " . "\\\\" . $vulnerability->device . " cmd /c move /y " . $output_array[2] . " C:\\evan";
            //addslashes($fix);
            echo $windows_fix;
        
            //$vulnerability->filename=$output_array[2];
            $vulnerability->windows_fix=$windows_fix;
            $vulnerability->save();


    /*$pyscript = 'C:\\wamp\\www\\testing\\scripts\\imageHandle.py';
    $python = 'C:\\Python27\\python.exe';
    $filePath = 'C:\\wamp\\www\\testing\\uploads\\thumbs\\10-05-2012-523.jpeg'

    THIS IS THE SOLUTION as you can read in the answer.

    $cmd = "$python $pyscript $filePath";
    exec("$cmd", $output);*/

        });
        
    }

    public function image()
    {
        // configure with favored image driver (gd by default)
        Image::configure(array('driver' => 'imagick'));
        $image = Image::make('public/hooded.jepg')->resize(300, 200);

    }


}
